function Controller(){function e(){e.opts||{};for(var t=l.models,i=t.length,o=[],r=0;i>r;r++){var a=t[r];a.__transform={};var s=Ti.UI.createTableViewRow({dataId:a.__transform.id!==void 0?a.__transform.id:a.get("id"),model:a.__transform.id!==void 0?a.__transform.id:a.get("id"),title:a.__transform.name!==void 0?a.__transform.name:a.get("name")});o.push(s)}n.__views.tblview.setData(o)}function t(e){globaldelete(e,g,c,d,T,f,n.tblview),Ti.API.info("e_id:"+e.rowData.dataId)}function i(e){if(""!=g){var t=Alloy.Globals.RELATIONSHIP[h],i="",o="";if(Ti.API.info(t),Alloy.Globals.RELATIONSHIP[h][f]!==void 0)o=Alloy.Globals.RELATIONSHIP[h].sModelname,globalopenDetail(e,o);else{i=Alloy.Globals.RELATIONSHIP[h].related[f].manytomanytblname,o=Alloy.Globals.RELATIONSHIP[h].related[f].manytomanyModelname;var n=Ti.Database.open("_alloy_"),r=n.execute("SELECT id FROM "+i+" WHERE "+Alloy.Globals.RELATIONSHIP[f].singlename+"_id = ? AND "+d+"_id = ?",T,e.rowData.dataId);if(1==r.getRowCount()){var a=Alloy.Collections[o];a.fetch();var l=Alloy.createController(i+"Edit",{parentTab:Alloy.Globals.tabGroup.getActiveTab(),dataId:r.fieldByName("id"),model:a.get(r.fieldByName("id"))}),s=l.getView(),c=Alloy.Globals.tabGroup.getActiveTab();c.open(s),n.close()}else alert("Error: you have duplicate records!")}}else globalopenDetail(e,u)}function o(e){var t=I.models.length;Ti.API.info(t);var i=[],o=Ti.Network.createHTTPClient({onerror:function(e){Ti.API.debug(e.error),alert("There was an error during the connection")},timeout:1e3}),r=t/20+1;o.open("GET",Alloy.Globals.BASEURL+c+"/page:"+(""+r)),o.send(),o.onload=function(){var o=JSON.parse(this.responseText);0==o.length&&(n.table.headerTitle="The database row is empty");for(var r=o,a=0,l=r.length;l>a;a++)i.push(r[a][u]);Alloy.Collections[u].reset(i),Alloy.Collections[u].each(function(e){e.save()});var s=Alloy.Collections[u];s.fetch({data:{offset:t},add:!0,silent:!0,success:function(i){Ti.API.info("successful here"),i.models.length===t?e.done():e.success()},error:e.error})}}require("alloy/controllers/BaseController").apply(this,Array.prototype.slice.call(arguments)),this.__controllerPath="workers",arguments[0]?arguments[0].__parentSymbol:null,arguments[0]?arguments[0].$model:null,arguments[0]?arguments[0].__itemTemplate:null;var n=this,r={},a={};Alloy.Collections.instance("Worker"),n.__views.tblviewWindow=Ti.UI.createWindow({backgroundColor:"white",id:"tblviewWindow",fullscreen:"false"}),n.__views.tblviewWindow&&n.addTopLevelView(n.__views.tblviewWindow),n.__views.editme=Ti.UI.createButton({top:10,title:"Edit",id:"editme"}),n.__views.tblviewWindow.rightNavButton=n.__views.editme,n.__views.activityIndicator=Ti.UI.createActivityIndicator({height:Ti.UI.SIZE,width:Ti.UI.SIZE,top:20,style:Ti.UI.iPhone.ActivityIndicatorStyle.DARK,id:"activityIndicator"}),n.__views.tblviewWindow.add(n.__views.activityIndicator),n.__views.labelNoRecords=Ti.UI.createLabel({width:Ti.UI.SIZE,height:Ti.UI.SIZE,color:"#000",visible:!1,top:20,id:"labelNoRecords"}),n.__views.tblviewWindow.add(n.__views.labelNoRecords),n.__views.__alloyId50=Ti.UI.createSearchBar({id:"__alloyId50"}),n.__views.tblview=Ti.UI.createTableView({height:Ti.UI.SIZE,top:0,search:n.__views.__alloyId50,searchHidden:"true",id:"tblview",editable:"true",filterAttribute:"title"}),n.__views.tblviewWindow.add(n.__views.tblview),n.__views.is=Alloy.createWidget("nl.fokkezb.infiniteScroll","widget",{id:"is",__parentSymbol:n.__views.tblview}),n.__views.is.setParent(n.__views.tblview),o?n.__views.is.on("end",o):a["$.__views.is!end!myLoader"]=!0;var l=Alloy.Collections.Worker||Worker;l.on("fetch destroy change add remove reset",e);var s=[];n.__views.camera=Ti.UI.createButton({top:10,id:"camera",systemButton:Ti.UI.iPhone.SystemButton.CAMERA}),s.push(n.__views.camera),n.__views.__alloyId59=Ti.UI.createButton({systemButton:Ti.UI.iPhone.SystemButton.FLEXIBLE_SPACE}),s.push(n.__views.__alloyId59),n.__views.refresh=Ti.UI.createButton({top:10,id:"refresh",systemButton:Ti.UI.iPhone.SystemButton.REFRESH}),s.push(n.__views.refresh),n.__views.__alloyId60=Ti.UI.createButton({systemButton:Ti.UI.iPhone.SystemButton.FLEXIBLE_SPACE}),s.push(n.__views.__alloyId60),n.__views.addbtn=Ti.UI.createButton({top:10,id:"addbtn",systemButton:Ti.UI.iPhone.SystemButton.ADD}),s.push(n.__views.addbtn),n.__views.__alloyId56=Ti.UI.iOS.createToolbar({items:s,bottom:"0",borderTop:"true",borderBottom:"false",id:"__alloyId56"}),n.__views.tblviewWindow.add(n.__views.__alloyId56),r.destroy=function(){l.off("fetch destroy change add remove reset",e)},_.extend(n,n.__views);var d="worker",c="workers",u="Worker",h="workers",v="",w="related widgets",m=!1,p=arguments[0]||{},g=p.parentTab||"",f=p.manytomanyaddscreen,y=p.related,T=0===p.dataId||p.dataId>0?p.dataId:"";n.addbtn.addEventListener("click",function(){globalopenAddItem(g,y,c,d,f,T)}),n.refresh.addEventListener("click",function(){globalgetrecords(c,u)}),n.editme.addEventListener("click",function(e){globaledittable(e,n.tblview)}),n.tblview.addEventListener("delete",function(e){t(e)}),n.tblview.addEventListener("longpress",function(e){globalopenDetail(e,u)});var I=Alloy.Collections[u];I.fetch(),globalgetrecords(c,u),n.tblview.addEventListener("click",function(e){""!=g?i(e):globalopenChild(e,v,w,m,c,g)}),n.tblviewWindow.addEventListener("focus",function(){if(""!=g){Ti.API.info("args not empty!");var e=Alloy.Collections[u],t=Ti.Database.open("_alloy_");if(1==y){var i=Alloy.Globals.RELATIONSHIP[c].related[f].manytomanytblname,o=t.execute("SELECT "+d+"_id FROM "+i+" WHERE "+Alloy.Globals.RELATIONSHIP[f].singlename+"_id = ?",T);if(0!=o.rowCount){for(var r="";o.isValidRow();)r=r+o.fieldByName(d+"_id")+",",o.next();t.close(),r=r.substring(0,r.length-1)+")",e.fetch({query:"SELECT * FROM "+h+" WHERE id IN ("+r})}else e.fetch({query:"SELECT * from "+i+" WHERE id = 0;"}),n.tblview.headerTitle="The database row is empty"}else e.fetch({query:"SELECT * FROM "+h+" WHERE "+Alloy.Globals.RELATIONSHIP[f].singlename+"_id ="+T})}else{Ti.API.info("args empty!");var e=Alloy.Collections[u];e.fetch()}}),a["$.__views.is!end!myLoader"]&&n.__views.is.on("end",o),_.extend(n,r)}var Alloy=require("alloy"),Backbone=Alloy.Backbone,_=Alloy._;module.exports=Controller;