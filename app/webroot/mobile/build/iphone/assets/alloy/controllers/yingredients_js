function Controller(){function e(){e.opts||{};for(var t=l.models,i=t.length,n=[],r=0;i>r;r++){var a=t[r];a.__transform={};var s=Ti.UI.createTableViewRow({dataId:a.__transform.id!==void 0?a.__transform.id:a.get("id"),model:a.__transform.id!==void 0?a.__transform.id:a.get("id"),title:a.__transform.searchvalue!==void 0?a.__transform.searchvalue:a.get("searchvalue")});n.push(s)}o.__views.tblview.setData(n)}function t(e){var t=Alloy.Collections.Yingredient,i=Alloy.createController("detail",{parentTab:Alloy.Globals.tabGroup.getActiveTab(),dataId:e.rowData.dataId,model:t.get(e.rowData.dataId)}),n=i.getView(),r=Alloy.Globals.tabGroup.getActiveTab();r.open(n)}function i(){if(""!=u){Ti.App.addEventListener("changefield",function(e){var t=Ti.Database.open("_alloy_");t.execute("INSERT INTO recipes_yingredients (recipe_id, yingredient_id, itemqty) Values(?,?,?)",h,e.value,1),Ti.API.info("INSERT!"),t.close()});var e=Alloy.createController("yingredientschooser").getView();e.open()}else{var e=Alloy.createController("yingredientsAdd").getView();e.open()}}function n(e){"Edit"==e.source.title?(o.tblview.editable=!1,o.tblview.editing=!0,o.tblview.editing=!1,o.tblview.editing=!0,o.tblview.moving=!0,e.source.title="Done"):(o.tblview.editable=!0,o.tblview.editing=!1,o.tblview.moving=!1,e.source.title="Edit")}function r(e){var t=Alloy.Collections.Yingredient,i=t.models.length;Ti.API.info(i);var n=[],r=Ti.Network.createHTTPClient({onerror:function(e){Ti.API.debug(e.error),alert("There was an error during the connection")},timeout:1e3}),a=i/20+1;r.open("GET","http://www.derekstearns.com/dinnernew/yingredients/mobileindex/page:"+(""+a)),r.send(),r.onload=function(){var t=JSON.parse(this.responseText);0==t.length&&(o.table.headerTitle="The database row is empty");for(var r=t,a=0,s=r.length;s>a;a++)n.push(r[a].Yingredient);Alloy.Collections.Yingredient.reset(n),Alloy.Collections.Yingredient.each(function(e){e.save()});var l=Alloy.Collections.Yingredient;l.fetch({data:{offset:i},add:!0,silent:!0,success:function(t){Ti.API.info("successful here in YIn"),t.models.length===i?e.done():e.success()},error:e.error})}}require("alloy/controllers/BaseController").apply(this,Array.prototype.slice.call(arguments)),this.__controllerPath="yingredients",arguments[0]?arguments[0].__parentSymbol:null,arguments[0]?arguments[0].$model:null,arguments[0]?arguments[0].__itemTemplate:null;var o=this,a={},s={};Alloy.Collections.instance("Yingredient"),o.__views.tblviewWindow=Ti.UI.createWindow({backgroundColor:"white",id:"tblviewWindow",fullscreen:"false"}),o.__views.tblviewWindow&&o.addTopLevelView(o.__views.tblviewWindow),o.__views.editme=Ti.UI.createButton({top:10,title:"Edit",id:"editme"}),o.__views.tblviewWindow.rightNavButton=o.__views.editme,o.__views.activityIndicator=Ti.UI.createActivityIndicator({height:Ti.UI.SIZE,width:Ti.UI.SIZE,top:20,style:Ti.UI.iPhone.ActivityIndicatorStyle.DARK,id:"activityIndicator"}),o.__views.tblviewWindow.add(o.__views.activityIndicator),o.__views.labelNoRecords=Ti.UI.createLabel({width:Ti.UI.SIZE,height:Ti.UI.SIZE,color:"#000",visible:!1,top:20,id:"labelNoRecords"}),o.__views.tblviewWindow.add(o.__views.labelNoRecords),o.__views.__alloyId37=Ti.UI.createSearchBar({id:"__alloyId37"}),o.__views.tblview=Ti.UI.createTableView({height:Ti.UI.SIZE,top:0,search:o.__views.__alloyId37,searchHidden:"true",id:"tblview",editable:"true",filterAttribute:"title"}),o.__views.tblviewWindow.add(o.__views.tblview),o.__views.is=Alloy.createWidget("nl.fokkezb.infiniteScroll","widget",{id:"is",__parentSymbol:o.__views.tblview}),o.__views.is.setParent(o.__views.tblview),r?o.__views.is.on("end",r):s["$.__views.is!end!myLoader"]=!0;var l=Alloy.Collections.Yingredient||Yingredient;l.on("fetch destroy change add remove reset",e);var d=[];o.__views.camera=Ti.UI.createButton({top:10,id:"camera",systemButton:Ti.UI.iPhone.SystemButton.CAMERA}),d.push(o.__views.camera),o.__views.__alloyId46=Ti.UI.createButton({systemButton:Ti.UI.iPhone.SystemButton.FLEXIBLE_SPACE}),d.push(o.__views.__alloyId46),o.__views.refresh=Ti.UI.createButton({top:10,id:"refresh",systemButton:Ti.UI.iPhone.SystemButton.REFRESH}),d.push(o.__views.refresh),o.__views.__alloyId47=Ti.UI.createButton({systemButton:Ti.UI.iPhone.SystemButton.FLEXIBLE_SPACE}),d.push(o.__views.__alloyId47),o.__views.addbtn=Ti.UI.createButton({top:10,id:"addbtn",systemButton:Ti.UI.iPhone.SystemButton.ADD}),d.push(o.__views.addbtn),o.__views.__alloyId43=Ti.UI.iOS.createToolbar({items:d,bottom:"0",borderTop:"true",borderBottom:"false",id:"__alloyId43"}),o.__views.tblviewWindow.add(o.__views.__alloyId43),a.destroy=function(){l.off("fetch destroy change add remove reset",e)},_.extend(o,o.__views);var c=arguments[0]||{},u=c.parentTab||"",h=0===c.dataId||c.dataId>0?c.dataId:"";o.addbtn.addEventListener("click",function(){i()}),o.refresh.addEventListener("click",function(){}),o.editme.addEventListener("click",function(e){n(e)}),o.tblview.addEventListener("longpress",function(e){t(e)}),o.tblview.addEventListener("click",function(e){""!=u||t(e)}),o.tblviewWindow.addEventListener("focus",function(){if(""!=u){Ti.API.info("args not empty!");var e=Alloy.Collections.Yingredient,t=Ti.Database.open("_alloy_"),i=t.execute("SELECT yingredient_id FROM recipes_yingredients WHERE recipe_id = ?",h);Ti.API.info(i.getRowCount());for(var n="(";i.isValidRow();)n=n+i.fieldByName("yingredient_id")+",",i.next();t.close(),n=n.substring(0,n.length-1)+")",e.fetch({query:"SELECT * FROM yingredient WHERE id IN "+n})}else{Ti.API.info("args empty!");var e=Alloy.Collections.Yingredient;e.fetch()}}),s["$.__views.is!end!myLoader"]&&o.__views.is.on("end",r),_.extend(o,a)}var Alloy=require("alloy"),Backbone=Alloy.Backbone,_=Alloy._;module.exports=Controller;