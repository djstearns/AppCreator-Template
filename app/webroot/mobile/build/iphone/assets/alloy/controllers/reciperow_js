function Controller(){function e(){e.opts||{};for(var t=c.models,i=t.length,n=[],r=0;i>r;r++){var o=t[r];o.__transform={};var a=Ti.UI.createTableViewRow({dataId:o.__transform.id!==void 0?o.__transform.id:o.get("id"),title:o.__transform.name!==void 0?o.__transform.name:o.get("name")});n.push(a)}s.__views.tblview.setData(n)}function t(e){var t=Alloy.Collections.Thing;Ti.API.info(e.rowData.model);var i=Alloy.createController("detail",{parentTab:Alloy.Globals.tabGroup.getActiveTab(),dataId:e.rowData.dataId,model:t.get(e.rowData.dataId)}),n=i.getView(),r=Alloy.Globals.tabGroup.getActiveTab();r.open(n)}function i(e){var t=Alloy.createController("yingredients",{parentTab:Alloy.Globals.tabGroup.getActiveTab(),dataId:e.rowData.dataId}),i=t.getView(),n=Alloy.Globals.tabGroup.getActiveTab();n.open(i)}function n(e){"Edit"==e.source.title?(s.tblview.editable=!1,s.tblview.editing=!0,s.tblview.editing=!1,s.tblview.editing=!0,s.tblview.moving=!0,e.source.title="Done"):(s.tblview.editable=!0,s.tblview.editing=!1,s.tblview.moving=!1,e.source.title="Edit")}function r(){if(Ti.API.info("seeded: "+Ti.App.Properties.hasProperty("seeded")),!Ti.App.Properties.hasProperty("seeded")){var e=[],t=Ti.Network.createHTTPClient({onerror:function(e){Ti.API.debug(e.error),r(),alert("There was an error during the connection")},timeout:1e3});t.open("GET","http://www.derekstearns.com/dinnernew/recipes/mobileindex"),t.send(),t.onload=function(){var t=JSON.parse(this.responseText);0==t.length&&(s.table.headerTitle="The database row is empty");for(var i=t,n=0,r=i.length;r>n;n++)e.push(i[n].Recipe);Alloy.Collections.Thing.reset(e),Alloy.Collections.Thing.each(function(e){e.save()});var o=Alloy.Collections.Thing;o.fetch(),Ti.App.Properties.setString("seeded","yuppers")}}var i=Alloy.Collections.Thing;i.fetch()}function o(e){this.deleteRow(e.index);var t=e,i=Ti.Database.open("_alloy_");i.execute("DELETE * FROM recipe WHERE id = ?",e.index),Ti.API.info("DELETE * FROM recipes_yingredients WHERE id = "+e.index),i.close(),Ti.API.info("http://www.derekstearns.com/dinnernew/recipes/delete/"+e.index);var n=Ti.Network.createHTTPClient({onerror:function(e){Ti.API.debug(e.error),o(t),alert("There was an error during the connection")},timeout:1e3});n.open("GET","http://www.derekstearns.com/dinnernew/recipes/delete/"+e.index),n.send(),n.onload=function(){var e=JSON.parse(this.responseText);Ti.API.info(e)}}function a(e){var t=p.models.length;Ti.API.info(t);var i=[],n=Ti.Network.createHTTPClient({onerror:function(e){Ti.API.debug(e.error),alert("There was an error during the connection")},timeout:1e3}),r=t/20+1;n.open("GET","http://www.derekstearns.com/dinnernew/recipes/mobileindex/page:"+(""+r)),n.send(),n.onload=function(){var n=JSON.parse(this.responseText);0==n.length&&(s.table.headerTitle="The database row is empty");for(var r=n,o=0,a=r.length;a>o;o++)i.push(r[o].Recipe);Alloy.Collections.Thing.reset(i),Alloy.Collections.Thing.each(function(e){e.save()});var l=Alloy.Collections.Thing;l.fetch({data:{offset:t},add:!0,silent:!0,success:function(i){Ti.API.info("successful here"),i.models.length===t?e.done():e.success()},error:e.error})}}require("alloy/controllers/BaseController").apply(this,Array.prototype.slice.call(arguments)),this.__controllerPath="reciperow",arguments[0]?arguments[0].__parentSymbol:null,arguments[0]?arguments[0].$model:null,arguments[0]?arguments[0].__itemTemplate:null;var s=this,l={},d={};Alloy.Collections.instance("Thing"),s.__views.tblviewWindow=Ti.UI.createWindow({backgroundColor:"white",id:"tblviewWindow"}),s.__views.tblviewWindow&&s.addTopLevelView(s.__views.tblviewWindow),s.__views.editme=Ti.UI.createButton({top:10,title:"Edit",id:"editme"}),s.__views.tblviewWindow.rightNavButton=s.__views.editme,s.__views.activityIndicator=Ti.UI.createActivityIndicator({height:Ti.UI.SIZE,width:Ti.UI.SIZE,top:20,style:Ti.UI.iPhone.ActivityIndicatorStyle.DARK,id:"activityIndicator"}),s.__views.tblviewWindow.add(s.__views.activityIndicator),s.__views.labelNoRecords=Ti.UI.createLabel({width:Ti.UI.SIZE,height:Ti.UI.SIZE,color:"#000",visible:!1,top:20,id:"labelNoRecords"}),s.__views.tblviewWindow.add(s.__views.labelNoRecords),s.__views.__alloyId22=Ti.UI.createSearchBar({id:"__alloyId22"}),s.__views.tblview=Ti.UI.createTableView({height:Ti.UI.SIZE,top:0,search:s.__views.__alloyId22,searchHidden:"true",id:"tblview",editable:"true",filterAttribute:"title"}),s.__views.tblviewWindow.add(s.__views.tblview),s.__views.is=Alloy.createWidget("nl.fokkezb.infiniteScroll","widget",{id:"is",__parentSymbol:s.__views.tblview}),s.__views.is.setParent(s.__views.tblview),a?s.__views.is.on("end",a):d["$.__views.is!end!myLoader"]=!0;var c=Alloy.Collections.Thing||Thing;c.on("fetch destroy change add remove reset",e);var u=[];s.__views.camera=Ti.UI.createButton({top:10,id:"camera",systemButton:Ti.UI.iPhone.SystemButton.CAMERA}),u.push(s.__views.camera),s.__views.__alloyId31=Ti.UI.createButton({systemButton:Ti.UI.iPhone.SystemButton.FLEXIBLE_SPACE}),u.push(s.__views.__alloyId31),s.__views.refresh=Ti.UI.createButton({top:10,id:"refresh",systemButton:Ti.UI.iPhone.SystemButton.REFRESH}),u.push(s.__views.refresh),s.__views.__alloyId32=Ti.UI.createButton({systemButton:Ti.UI.iPhone.SystemButton.FLEXIBLE_SPACE}),u.push(s.__views.__alloyId32),s.__views.addbtn=Ti.UI.createButton({top:10,id:"addbtn",systemButton:Ti.UI.iPhone.SystemButton.ADD}),u.push(s.__views.addbtn),s.__views.__alloyId28=Ti.UI.iOS.createToolbar({items:u,bottom:"0",borderTop:"true",borderBottom:"false",id:"__alloyId28"}),s.__views.tblviewWindow.add(s.__views.__alloyId28),l.destroy=function(){c.off("fetch destroy change add remove reset",e)},_.extend(s,s.__views);var h=arguments[0]||{};h.parentTab||"",0===h.dataId||h.dataId>0?h.dataId:"",s.addbtn.addEventListener("click",function(){Ti.API.info("clicked edit")}),s.refresh.addEventListener("click",function(){r()}),s.editme.addEventListener("click",function(e){n(e)}),s.tblview.addEventListener("longpress",function(e){t(e)});var p=Alloy.Collections.Thing;p.fetch(),r(),s.tblview.addEventListener("click",function(e){e.source===e.row.DeleteRow?o(e):i(e)}),d["$.__views.is!end!myLoader"]&&s.__views.is.on("end",a),_.extend(s,l)}var Alloy=require("alloy"),Backbone=Alloy.Backbone,_=Alloy._;module.exports=Controller;