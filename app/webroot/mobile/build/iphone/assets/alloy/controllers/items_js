function Controller(){function e(){e.opts||{};for(var t=l.models,i=t.length,r=[],n=0;i>n;n++){var s=t[n];s.__transform={};var a=Ti.UI.createTableViewRow({dataId:s.__transform.id!==void 0?s.__transform.id:s.get("id"),title:s.__transform.name!==void 0?s.__transform.name:s.get("name")});r.push(a)}o.__views.tblview.setData(r)}function t(e){var t=Alloy.Collections.Item;Ti.API.info(e.rowData.model);var i=Alloy.createController("detail",{parentTab:Alloy.Globals.tabGroup.getActiveTab(),dataId:e.rowData.dataId,model:t.get(e.rowData.dataId)}),r=i.getView(),n=Alloy.Globals.tabGroup.getActiveTab();n.open(r)}function i(){Ti.API.info("seeded I: "+Ti.App.Properties.hasProperty("seeded"));var e=[],t=Ti.Network.createHTTPClient({onerror:function(e){Ti.API.debug(e.error),alert("There was an error during the connection")},timeout:1e3});t.open("POST","http://www.derekstearns.com/dinnernew/items/mobileindex.json"),t.setRequestHeader("Content-Type","application/json"),t.send({token:Ti.App.Properties.getString("token")}),t.onload=function(){var t=JSON.parse(this.responseText);Ti.API.info(this.responseText+"items"),0==t.length&&(o.table.headerTitle="The database row is empty");for(var i=t,r=0,n=i.length;n>r;r++)e.push(i[r].Item);Alloy.Collections.Item.reset(e),Alloy.Collections.Item.each(function(e){e.save()});var s=Alloy.Collections.Item;s.fetch(),Ti.App.Properties.setString("seeded","yuppers")}}function r(e){Ti.API.info("delete clicked!"),alert(e);var t=Ti.Database.open("_alloy_");t.execute("DELETE FROM item WHERE id = ?",e.rowData.dataId),Ti.API.info("DELETE * FROM items WHERE id = "+e.rowData.dataId),t.close(),Ti.API.info("http://www.derekstearns.com/dinnernew/items/mobiledelete/"+e.rowData.dataId);var i=Ti.Network.createHTTPClient({onerror:function(e){Ti.API.debug(e.error),r(d),alert("There was an error during the connection")},timeout:1e3});i.open("GET","http://www.derekstearns.com/dinnernew/items/mobiledelete/"+e.rowData.dataId),i.send(),i.onload=function(){var e=JSON.parse(this.responseText);Ti.API.info(e)}}function n(e){var t=h.models.length;Ti.API.info(t);var i=[],r=Ti.Network.createHTTPClient({onerror:function(e){Ti.API.debug(e.error),alert("There was an error during the connection")},timeout:1e3}),n=t/20+1;r.open("GET","http://www.derekstearns.com/dinnernew/items/mobileindex/page:"+(""+n)),r.send(),r.onload=function(){var r=JSON.parse(this.responseText);0==r.length&&(o.table.headerTitle="The database row is empty");for(var n=r,s=0,a=n.length;a>s;s++)i.push(n[s].Item);Alloy.Collections.Item.reset(i),Alloy.Collections.Item.each(function(e){e.save()});var l=Alloy.Collections.Item;l.fetch({data:{offset:t},add:!0,silent:!0,success:function(i){Ti.API.info("successful here"),i.models.length===t?e.done():e.success()},error:e.error})}}require("alloy/controllers/BaseController").apply(this,Array.prototype.slice.call(arguments)),this.__controllerPath="items",arguments[0]?arguments[0].__parentSymbol:null,arguments[0]?arguments[0].$model:null,arguments[0]?arguments[0].__itemTemplate:null;var o=this,s={},a={};Alloy.Collections.instance("Item"),o.__views.tblviewWindow=Ti.UI.createWindow({backgroundColor:"white",id:"tblviewWindow"}),o.__views.tblviewWindow&&o.addTopLevelView(o.__views.tblviewWindow),o.__views.editme=Ti.UI.createButton({top:10,title:"Edit",id:"editme"}),o.__views.tblviewWindow.rightNavButton=o.__views.editme,o.__views.activityIndicator=Ti.UI.createActivityIndicator({height:Ti.UI.SIZE,width:Ti.UI.SIZE,top:20,style:Ti.UI.iPhone.ActivityIndicatorStyle.DARK,id:"activityIndicator"}),o.__views.tblviewWindow.add(o.__views.activityIndicator),o.__views.labelNoRecords=Ti.UI.createLabel({width:Ti.UI.SIZE,height:Ti.UI.SIZE,color:"#000",visible:!1,top:20,id:"labelNoRecords"}),o.__views.tblviewWindow.add(o.__views.labelNoRecords),o.__views.__alloyId8=Ti.UI.createSearchBar({id:"__alloyId8"}),o.__views.tblview=Ti.UI.createTableView({height:Ti.UI.SIZE,top:0,search:o.__views.__alloyId8,searchHidden:"true",id:"tblview",moveable:"true",editable:"true",filterAttribute:"title"}),o.__views.tblviewWindow.add(o.__views.tblview),o.__views.is=Alloy.createWidget("nl.fokkezb.infiniteScroll","widget",{id:"is",__parentSymbol:o.__views.tblview}),o.__views.is.setParent(o.__views.tblview),n?o.__views.is.on("end",n):a["$.__views.is!end!myLoader"]=!0;var l=Alloy.Collections.Item||Item;l.on("fetch destroy change add remove reset",e);var c=[];o.__views.camera=Ti.UI.createButton({top:10,id:"camera",systemButton:Ti.UI.iPhone.SystemButton.CAMERA}),c.push(o.__views.camera),o.__views.__alloyId17=Ti.UI.createButton({systemButton:Ti.UI.iPhone.SystemButton.FLEXIBLE_SPACE}),c.push(o.__views.__alloyId17),o.__views.refresh=Ti.UI.createButton({top:10,id:"refresh",systemButton:Ti.UI.iPhone.SystemButton.REFRESH}),c.push(o.__views.refresh),o.__views.__alloyId18=Ti.UI.createButton({systemButton:Ti.UI.iPhone.SystemButton.FLEXIBLE_SPACE}),c.push(o.__views.__alloyId18),o.__views.addbtn=Ti.UI.createButton({top:10,id:"addbtn",systemButton:Ti.UI.iPhone.SystemButton.ADD}),c.push(o.__views.addbtn),o.__views.__alloyId14=Ti.UI.iOS.createToolbar({items:c,bottom:"0",borderTop:"true",borderBottom:"false",id:"__alloyId14"}),o.__views.tblviewWindow.add(o.__views.__alloyId14),s.destroy=function(){l.off("fetch destroy change add remove reset",e)},_.extend(o,o.__views);var u=arguments[0]||{};u.parentTab||"",0===u.dataId||u.dataId>0?u.dataId:"",o.addbtn.addEventListener("click",function(){var e=Alloy.createController("itemsAdd").getView();e.open()}),o.refresh.addEventListener("click",function(){i()}),o.editme.addEventListener("click",function(e){"Edit"==e.source.title?(o.tblview.editable=!1,o.tblview.editing=!0,o.tblview.editing=!1,o.tblview.editing=!0,o.tblview.moving=!0,e.source.title="Done"):(o.tblview.editable=!0,o.tblview.editing=!1,o.tblview.moving=!1,e.source.title="Edit")}),o.tblview.addEventListener("delete",function(e){r(e)}),o.tblview.addEventListener("longpress",function(e){t(e)});var h=Alloy.Collections.Item;h.fetch(),i(),o.tblview.addEventListener("click",function(e){t(e)}),a["$.__views.is!end!myLoader"]&&o.__views.is.on("end",n),_.extend(o,s)}var Alloy=require("alloy"),Backbone=Alloy.Backbone,_=Alloy._;module.exports=Controller;