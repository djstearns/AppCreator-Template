var loggedIn=!1;Ti.App.Properties.getString("loggedIn")&&(loggedIn=!0),exports.isLoggedIn=function(){return loggedIn},exports.login=function(e,t,i){var o=Ti.Network.createHTTPClient({onerror:function(e){Ti.API.debug(e.error),alert("Could not login."),setTimeout(function(){i({result:"not ok"})},5e3)},timeout:5e3});o.onload=function(){var e=JSON.parse(this.responseText);Ti.API.info("message: "+e.message),Ti.API.info("token: "+e.token),Ti.App.Properties.setString("token",e.token),""!=e.token?(loggedIn=!0,Ti.App.Properties.setString("loggedIn",1),setTimeout(function(){i({result:"ok"})},5e3)):setTimeout(function(){i({result:"loaded, but not ok"})},5e3)},Ti.API.info("calling "+Alloy.Globals.BASEURL+"users/loginjson.json"),o.open("POST",Alloy.Globals.BASEURL+"users/loginjson.json"),o.send({username:e,passwd:t})},exports.logout=function(e){loggedIn=!1,Ti.App.Properties.removeProperty("loggedIn"),Ti.App.Properties.removeProperty("token"),e({result:"ok"})};var dataStore=[],dataBuilt=!1;exports.deleteItem=function(e){dataStore.splice(e,1)},exports.getItem=function(e){return dataStore[e]},exports.getAll=function(){return dataStore};